(this.webpackJsonpchatapp=this.webpackJsonpchatapp||[]).push([[0],{131:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(38),o=t.n(c),i=(t(94),t(8)),l=(t(95),t(159)),s=t(145),m=t(165),u=t(42),d=t(163),p=t(19),f=t(14);t(27);var g=function(e){return r.a.createElement(l.a,{theme:p.grommet,className:"navigation"},r.a.createElement(s.a,{background:"brand",pad:"small",height:{min:"72px"}},e.avatarmessage?r.a.createElement(m.a,{background:"accent-4"},e.avatarmessage):r.a.createElement(r.a.Fragment,null),r.a.createElement(u.a,{direction:"row",gap:"medium"},r.a.createElement(d.a,{label:"Project 6",href:"https://flaviocopes.com/sample-app-ideas/",className:"link"}),r.a.createElement(f.b,{to:"/"},"Home"),r.a.createElement(f.b,{to:"/login"},"Login"),r.a.createElement(f.b,{to:"/createuser"},"Create User"),r.a.createElement(f.b,{to:"/conversation"},"Convo"))))},h=t(149),E=t(150),v=t(158),b=t(164),x=t(160),w=t(151),j=t(21),y=t(84),O=t(166),k=t(162),S=t(148),I=t(15),U=t.n(I);var C=function(e){var a,t=r.a.useState(""),c=Object(i.a)(t,2),o=c[0],s=c[1],d=r.a.useState([]),g=Object(i.a)(d,2),h=g[0],E=g[1],x=Object(n.useRef)(null);Object(n.useEffect)((function(){""!==e.updateUserInfo&&x.current.scrollIntoView({behavior:"auto"})}),[h]),Object(n.useEffect)((function(){E(e.chatHistory)}),[e.chatHistory]);var w=function(){var a={to:e.selecteduser,from:e.updateUserInfo,read:!1,chatHistory:o};U.a.post("/conversation/addconversation",a).then((function(a){console.log(e,"props"),console.log("props.updateUserInfo: ",e.updateUserInfo),console.log(" res.chatHistory: ",a.chatHistory),console.log(a,"res"),""!==e.updateUserInfo&&0===a.chatHistory.length&&e.testingFunction("rerenderSidebar")})).catch((function(e){return console.log(e,"error")})),E([].concat(Object(y.a)(h),[a]))};return r.a.createElement(l.a,{theme:p.grommet},r.a.createElement(u.a,{direction:"column",full:!0,margin:"medium",className:"conversation",overflow:"hidden",style:{marginRight:"0 !importnat"}},r.a.createElement(u.a,{width:"100%",className:"conversation-header"},r.a.createElement(O.a,{margin:"none",level:3},"Conversation with: ",e.selecteduser)),""!==e.updateUserInfo?r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,{height:{min:"calc(100vh - 219px)",max:"calc(100vh - 219px)"},overflow:"scroll",style:{overflowY:"scroll",overflowX:"hidden",paddingRight:"5px"}},h.map((function(a,t){return r.a.createElement(u.a,{key:t,height:{min:"auto"},style:{margin:"1px 0"}},a.from===e.updateUserInfo?r.a.createElement(u.a,{direction:"row",justify:"end"},r.a.createElement(b.a,{alignSelf:"center",margin:"small"},a.chatHistory),r.a.createElement(m.a,{background:"accent-4",className:"avatar-convo"},a.from.slice(0,1).toUpperCase())):r.a.createElement(u.a,{direction:"row"},r.a.createElement(m.a,{background:"brand",className:"avatar-convo"},a.from.slice(0,1).toUpperCase()),r.a.createElement(b.a,{alignSelf:"center",margin:"small"},a.chatHistory)))})),r.a.createElement("div",{ref:x})),r.a.createElement(u.a,{direction:"row"},r.a.createElement(k.a,{placeholder:"type here",value:o,onChange:function(e){return s(e.target.value)},resize:!1,onKeyPress:function(e){13!=e.which||e.shiftKey||(w(),s(""))}}),r.a.createElement(u.a,{pad:"small",alignSelf:"center",justify:"center"},r.a.createElement(v.a,(a={type:"submit",gap:"medium",plain:!0,onClick:function(){w(),s("")}},Object(j.a)(a,"plain",!0),Object(j.a)(a,"icon",r.a.createElement(S.a,null)),a))))):r.a.createElement(u.a,{height:{min:"calc(100vh - 238px)",max:"calc(100vh - 250px)"},justify:"center",width:"100%",align:"center"},r.a.createElement(O.a,{margin:"none",level:3},"Looks like you're not logged in"),r.a.createElement(f.b,{to:"/login"},"Log In"))))};var A=function(e){var a=Object(n.useState)(!1),t=Object(i.a)(a,2),c=t[0],o=t[1],s=Object(n.useState)([]),m=Object(i.a)(s,2),d=m[0],f=m[1],g=Object(n.useState)([]),j=Object(i.a)(g,2),y=j[0],O=j[1],k=Object(n.useState)([]),S=Object(i.a)(k,2),I=S[0],A=S[1],N=Object(n.useState)([]),H=Object(i.a)(N,2),L=H[0],F=H[1],z=r.a.useState(""),P=Object(i.a)(z,2),R=P[0],G=P[1];Object(n.useEffect)((function(){q(),""!==e.updateUserInfo&&K()}),[]);var q=function(){U.a.get("/user/allusers/",{params:{username:e.updateUserInfo}}).then((function(e){var a=e.data.map((function(e){return e.username}));f(a)})).catch((function(e){return console.log(e,"axioserrors")}))},B=function(a){var t={to:a,from:e.updateUserInfo};U.a.get("/conversation/selectedconvo",{params:t}).then((function(e){F(e.data)})).catch((function(e){console.log(e,"not able to find user ")}))},K=function(){var a={user:e.updateUserInfo};U.a.get("/conversation/friends",{params:a}).then((function(e){O(e.data)})).catch((function(e){console.log(e,"error")}))},W=function(a){var t={to:a,from:e.updateUserInfo};U.a.post("/conversation/updateunread",t).then((function(e){})).catch((function(e){return console.log(e,"errroraxios")}))};return r.a.createElement(l.a,{theme:p.grommet},r.a.createElement(u.a,{direction:"row",height:{min:"calc(100vh - 72px)"}},r.a.createElement(h.a,{responsive:!1,background:"brand",pad:{left:"medium",right:"large",vertical:"medium"},style:{padding:"0px",width:"600px"}},r.a.createElement(E.a,{gap:"large",responsive:!1},r.a.createElement(u.a,{pad:"small",style:{height:"calc(100% - 226px)",overflowY:"scroll"}},r.a.createElement(v.a,{gap:"medium",alignSelf:"start",plain:!0,label:"Add convo",reverse:!0,icon:r.a.createElement(w.a,null),onClick:function(){o(!1)}}),y.length>0&&y.map((function(e,a){return r.a.createElement(u.a,{direction:"row",justify:"between",className:"sidebar-item"},r.a.createElement(v.a,{className:"sidebar-button",gap:"medium",alignSelf:"start",plain:!0,label:"".concat(e.friend," "),reverse:!0,fill:!0,onClick:function(t){t.value;A(e.friend),o(!0),B(e.friend),y[a].unread=0,W(e.friend)}}),Number(e.unread)>0&&r.a.createElement(v.a,{gap:"medium",alignSelf:"start",plain:!0,label:e.unread,reverse:!0,pad:"small",onClick:function(t){t.value;A(e.friend),o(!0),B(e.friend),y[a].unread=0,W(e.friend)}}))}))))),r.a.createElement(u.a,{full:!0,width:{min:"calc(100% - 230px)"}},c>0?r.a.createElement(C,{selecteduser:I,updateUserInfo:e.updateUserInfo,chatHistory:L,testingFunction:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&K()}}):r.a.createElement(u.a,{width:{min:"100%"},pad:"large"},r.a.createElement(b.a,null,"Start a conversation here, select a person \ud83d\udcac "),r.a.createElement(x.a,{value:R,onChange:function(e){G(e.target.value)},onSelect:function(e){G(e.suggestion),A(e.suggestion),o(!0),B(e.suggestion),G("")},suggestions:d,className:"dropdown-convo"})))))},N=t(161),H=t(83),L=t.n(H),F={global:{font:{family:"Roboto",size:"18px",height:"20px"}}};var z=function(){return r.a.createElement(l.a,{theme:F},r.a.createElement(u.a,{direction:"row",height:{min:"calc(100vh - 72px)"},justify:"center",align:"center",pad:"medium",textAlign:"center"},r.a.createElement(u.a,{justify:"center",direction:"column",textAlign:"center",className:"createuser"},r.a.createElement(O.a,{margin:"none",level:3},"ChatApp, click here to get started"),r.a.createElement(f.b,{to:"/createuser"},"Create User")),r.a.createElement(u.a,{height:"medium"},r.a.createElement(N.a,{fit:"contain",src:L.a}))))},P=t(33),R=t.n(P),G=t(64),q=t(153),B=t(156),K=t(152),W=t(154),Z=t(155),J=t(125);t(126),t(128);J.initializeApp({apiKey:"AIzaSyBEE2-LZbh-BA_ZevH0FoANZ11-A7o9E1M",authDomain:"chatapp-befa6.firebaseapp.com",databaseURL:"https://chatapp-befa6.firebaseio.com",projectId:"chatapp-befa6",storageBucket:"chatapp-befa6.appspot.com",messagingSenderId:"337625400601",appId:"1:337625400601:web:cd8d7583825c47f2557188",measurementId:"G-8TEHGK6E0V"});var M=J;var V=function(){var e=r.a.useState(!1),a=Object(i.a)(e,2),t=a[0],n=a[1],c=r.a.useState(null),o=Object(i.a)(c,2),s=o[0],m=o[1],d=r.a.useState(""),f=Object(i.a)(d,2),g=f[0],h=f[1],E=function(e){return U.a.post("/user/createuser",e)},w=function(e,a,t){return U.a.get("/user/checkemail",{params:{email:e,username:a}})},y=function(){var e=Object(G.a)(R.a.mark((function e(){var a,t,r,c,o;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!1),a=new M.auth.GoogleAuthProvider,t=M.auth(),e.prev=3,e.next=6,t.signInWithPopup(a);case 6:return r=e.sent,c=r.user,o={username:c.displayName,email:c.email,isgoogleauthenticate:!0},m(o),e.next=12,w(o.email,o.displayName);case 12:if(0!==e.sent.data.length){e.next=26;break}return e.prev=14,e.next=17,E(o);case 17:e.sent,h("User Created"),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(14),h("incorrect info");case 24:e.next=27;break;case 26:h("Email or Username already used");case 27:e.next=31;break;case 29:e.prev=29,e.t1=e.catch(3);case 31:case"end":return e.stop()}}),e,null,[[3,29],[14,21]])})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(G.a)(R.a.mark((function e(a){var t;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=a).isgoogleauthenticate=!1,e.prev=2,m(t),e.next=6,w(t.email,t.username);case 6:if(0!==e.sent.data.length){e.next=20;break}return e.prev=8,e.next=11,E(t);case 11:e.sent,h("User Created"),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),h("incorrect info");case 18:e.next=21;break;case 20:h("Email or Username already used");case 21:e.next=25;break;case 23:e.prev=23,e.t1=e.catch(2);case 25:case"end":return e.stop()}}),e,null,[[2,23],[8,15]])})));return function(a){return e.apply(this,arguments)}}(),S=function(e){var a=e.announce,t=e.message,n=e.mode,c=e.role;return r.a.useEffect((function(){a(t,n,5e3)}),[a,t,n]),r.a.createElement(b.a,{align:"center",role:c,"aria-live":n},t)};return r.a.createElement(l.a,{theme:p.grommet},r.a.createElement(u.a,{direction:"column",height:{min:"calc(100vh - 72px)"},justify:"center",align:"center",className:"createuser"},r.a.createElement(O.a,Object(j.a)({margin:"none",level:3},"margin","small"),"Create User"),t?r.a.createElement(q.a,{onSubmit:function(e){var a=e.value;k(a)}},r.a.createElement(B.a,{name:"username",htmlfor:"textinput-id",label:"Username"},r.a.createElement(x.a,{id:"textinput-id",name:"username",required:!0})),r.a.createElement(B.a,{name:"password",htmlfor:"textinput-id",label:"Password"},r.a.createElement(x.a,{id:"textinput-id",name:"password",required:!0})),r.a.createElement(B.a,{name:"email",htmlfor:"textinput-id",label:"Email"},r.a.createElement(x.a,{id:"textinput-id",name:"email",required:!0})),r.a.createElement(u.a,{direction:"row",gap:"medium"},r.a.createElement(v.a,{type:"submit",primary:!0,label:"Submit"}),r.a.createElement(v.a,{type:"reset",label:"Reset"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,{width:{min:"250px"},pad:"small"},r.a.createElement(v.a,{fill:!0,label:"Create with Google",onClick:function(){y()},icon:r.a.createElement(W.a,{color:"plain",size:"medium"})})),r.a.createElement(u.a,{width:{min:"250px"}},r.a.createElement(v.a,{gap:"13px",fill:!0,label:"Create with Email",onClick:function(e){e.value;n(!0)},icon:r.a.createElement(Z.a,{color:"plain",size:"medium"})}))),r.a.createElement(u.a,{height:{min:"100px"},pad:"medium"},s&&r.a.createElement(K.a.Consumer,null,(function(e){return r.a.createElement(S,{announce:e,message:g,mode:"polite",role:"alert"})})))))};var Y=function(e){var a=r.a.useState(!1),t=Object(i.a)(a,2),c=t[0],o=t[1],s=r.a.useState(null),m=Object(i.a)(s,2),d=m[0],f=m[1],g=r.a.useState(""),h=Object(i.a)(g,2),E=h[0],w=h[1];Object(n.useEffect)((function(){}),[d]);var y=function(a,t,n){n?U.a.get("/user/checkemail",{params:{email:t,isgoogleauthenticate:a,password:n}}).then((function(a){0!==a.data.length?(w("Logged In"),e.updateAvatar(a.data[0].username.slice(0,1).toUpperCase()),e.userInfo(a.data[0].username)):w("Account Not Found")})).catch((function(e){console.log(e)})):U.a.get("/user/checkemail",{params:{email:t,isgoogleauthenticate:a}}).then((function(a){0!==a.data.length?(w("Logged In"),e.updateAvatar(a.data[0].username.slice(0,1).toUpperCase()),e.userInfo(a.data[0].username)):w("Account Not Found")})).catch((function(e){console.log(e)}))},k=function(e){var a=e.announce,t=e.message,n=e.mode,c=e.role;return r.a.useEffect((function(){a(t,n,5e3)}),[a,t,n]),r.a.createElement(b.a,{align:"center",role:c,"aria-live":n},t)};return r.a.createElement(l.a,{theme:p.grommet},r.a.createElement(u.a,{direction:"column",height:{min:"calc(100vh - 72px)"},justify:"center",align:"center",className:"login"},r.a.createElement(O.a,Object(j.a)({margin:"none",level:3},"margin","small"),"Login"),c?r.a.createElement(q.a,{onSubmit:function(e){!function(e){var a=e;a.isgoogleauthenticate=!1,f(a),y(!1,e.email,e.password)}(e.value)}},r.a.createElement(B.a,{name:"email",htmlfor:"textinput-id",label:"Email"},r.a.createElement(x.a,{id:"textinput-id",name:"email",required:!0})),r.a.createElement(B.a,{name:"password",htmlfor:"textinput-id",label:"Password"},r.a.createElement(x.a,{id:"textinput-id",name:"password",required:!0})),r.a.createElement(u.a,{direction:"row",gap:"medium"},r.a.createElement(v.a,{type:"submit",primary:!0,label:"Submit"}),r.a.createElement(v.a,{type:"reset",label:"Reset"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,{width:{min:"250px"},margin:"small"},r.a.createElement(v.a,{fill:!0,label:"Login with Google",onClick:function(){!function(){var e=new M.auth.GoogleAuthProvider;M.auth().signInWithPopup(e).then((function(e){var a=e.user,t={username:a.displayName,email:a.email,isgoogleauthenticate:!0};f(t),y(!0,a.email)})).catch((function(e){console.log(e,"error")}))}()},icon:r.a.createElement(W.a,{color:"plain",size:"medium"})})),r.a.createElement(u.a,{width:{min:"250px"}},r.a.createElement(v.a,{fill:!0,gap:"13px",label:"Login with Email",onClick:function(e){e.value;o(!0)},icon:r.a.createElement(Z.a,{color:"plain",size:"medium"})}))),r.a.createElement(u.a,{height:{min:"100px"},pad:"medium"},d&&r.a.createElement(K.a.Consumer,null,(function(e){return r.a.createElement(k,{announce:e,message:E,mode:"polite",role:"alert"})})))))},D=t(7);var T=function(){var e=Object(n.useState)(""),a=Object(i.a)(e,2),t=a[0],c=a[1],o=Object(n.useState)(""),l=Object(i.a)(o,2),s=l[0],m=l[1],u=function(e){c(e)},d=function(e){m(e)};return r.a.createElement(f.a,null,r.a.createElement(g,{avatarmessage:t}),r.a.createElement(D.a,{exact:!0,path:"/",render:function(e){return r.a.createElement(z,Object.assign({},e,{avatarmessage:t,isAuthed:!0}))}}),r.a.createElement(D.a,{path:"/createuser",render:function(e){return r.a.createElement(V,Object.assign({},e,{isAuthed:!0}))}}),r.a.createElement(D.a,{path:"/login",render:function(e){return r.a.createElement(Y,Object.assign({},e,{updateAvatar:u,userInfo:d,isAuthed:!0}))}}),r.a.createElement(D.a,{path:"/conversation",render:function(e){return r.a.createElement(A,Object.assign({},e,{isAuthed:!0,updateUserInfo:s}))}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},27:function(e,a,t){},83:function(e,a,t){e.exports=t.p+"static/media/phone.654828f4.png"},89:function(e,a,t){e.exports=t(131)},94:function(e,a,t){},95:function(e,a,t){}},[[89,1,2]]]);
//# sourceMappingURL=main.35c718c4.chunk.js.map